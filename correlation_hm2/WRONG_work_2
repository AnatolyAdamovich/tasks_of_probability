{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "b0872342",
   "metadata": {},
   "source": [
    "## Корреляционный анализ\n",
    "\n",
    "\n",
    "Биометрия.  \n",
    "Проверить: **есть ли зависимость** между возрастом (в месяцах) и весом самок павианов гамадрилов.  \n",
    "Если зависимость есть, то выяснить: **линейна она или нет**.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3c00a5c9",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4bda3ca0",
   "metadata": {},
   "source": [
    "### Данные"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "c1dac626",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Возраст X (мес)</th>\n",
       "      <th>Вес Y (кг)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>33.0</td>\n",
       "      <td>7.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>31.0</td>\n",
       "      <td>5.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>31.0</td>\n",
       "      <td>5.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>32.0</td>\n",
       "      <td>5.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>34.0</td>\n",
       "      <td>6.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>26.0</td>\n",
       "      <td>6.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>29.8</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>31.0</td>\n",
       "      <td>6.1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>32.5</td>\n",
       "      <td>6.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>32.5</td>\n",
       "      <td>5.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>24.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>28.5</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>26.0</td>\n",
       "      <td>5.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>28.5</td>\n",
       "      <td>6.7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>32.0</td>\n",
       "      <td>5.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>31.5</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>32.5</td>\n",
       "      <td>6.4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>34.0</td>\n",
       "      <td>6.3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>33.5</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>33.5</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Возраст X (мес)  Вес Y (кг)\n",
       "1              33.0         7.5\n",
       "2              31.0         5.7\n",
       "3              31.0         5.4\n",
       "4              32.0         5.8\n",
       "5              34.0         6.8\n",
       "6              26.0         6.2\n",
       "7              29.8         8.0\n",
       "8              31.0         6.1\n",
       "9              32.5         6.8\n",
       "10             32.5         5.6\n",
       "11             24.0         5.0\n",
       "12             28.5         5.0\n",
       "13             26.0         5.4\n",
       "14             28.5         6.7\n",
       "15             32.0         5.3\n",
       "16             31.5         5.5\n",
       "17             32.5         6.4\n",
       "18             34.0         6.3\n",
       "19             33.5         5.5\n",
       "20             33.5         6.0"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X = np.array([33, 31, 31, 32, 34, 26, 29.8,\n",
    "             31, 32.5, 32.5, 24, 28.5, 26, 28.5,\n",
    "             32, 31.5, 32.5, 34, 33.5, 33.5])\n",
    "\n",
    "Y = np.array([7.5, 5.7, 5.4, 5.8, 6.8,\n",
    "             6.2, 8, 6.1, 6.8, 5.6, 5, 5,\n",
    "             5.4, 6.7, 5.3, 5.5, 6.4,\n",
    "             6.3, 5.5, 6.0])\n",
    "\n",
    "data = pd.DataFrame({'Возраст X (мес)':X, \n",
    "                    'Вес Y (кг)': Y}, index = np.arange(1,len(X)+1))\n",
    "data"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "74756c94",
   "metadata": {},
   "source": [
    "### Коэффициент корреляции\n",
    "Сперва найдем по известным выборкам коэффциент корреляции, являющийся мерой линейной зависимости"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "1901e76c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Коэффициент корреляции равен 0.288\n"
     ]
    }
   ],
   "source": [
    "covariance = np.mean(X * Y) - np.mean(X) * np.mean(Y)\n",
    "correlation =  round(covariance / (np.std(X) * np.std(Y)), 3)\n",
    "print(f'Коэффициент корреляции равен {correlation}')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8ee7f355",
   "metadata": {},
   "source": [
    "Видим, что коэффициент корреляции больше нуля. Это значит, что большим значениям Y соответствуют большие значения Х. Рассмотрим на графике"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "002187a5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='Возраст X (мес)', ylabel='Вес Y (кг)'>"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYIAAAEGCAYAAABo25JHAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAZtklEQVR4nO3df7RdZX3n8ffnkksSSDDX5AIxoUYHShe2IaS3IKZ1VMRFGCZ0GkZx2WqxGsP4o9rlBB1bZ+rqaI1aR6UlE0WUEbFI+JHRQKFVW9eqib0JyYUKjFHB3AThelcIuZJcb7jf+WPvW05Ozv2VnOfsc87+vNY66+z97H33+T5wcr5n7/09z6OIwMzMyquj6ADMzKxYTgRmZiXnRGBmVnJOBGZmJedEYGZWcjOKDmC6FixYEEuWLCk6DDOzlrJ9+/afR0R3rW0tlwiWLFlCb29v0WGYmbUUSY+Pt82XhszMSs6JwMys5JwIzMxKzonAzKzknAjMzEouaSKQ9D5J/yrpIUm3SppVtV2SPitpt6Q+SctTxmPWygaHhtm152kGh4aLDsXaTLLyUUmLgPcA50XEIUm3AVcDX6rYbSVwTv64CLghfzazCnfv3Mt1m/ro7OhgZHSU9auXsmrZoqLDsjaR+tLQDGC2pBnAKcC+qu1XAjdHZiswT9LCxDGZtZTBoWGu29TH4ZFRDg4f4fDIKOs29fnMwOomWSKIiL3AJ4GfAk8AByLivqrdFgF7Ktb787ajSFojqVdS78DAQKqQzZpS//5DdHYc/U+1s6OD/v2HCorI2k2yRCCpi+wb/0uAFwGnSvr96t1q/OkxM+VExMaI6ImInu7umr+QNmtbi7tmMzI6elTbyOgoi7tmFxSRtZuUl4ZeC/wkIgYiYgS4A3hF1T79wFkV64s59vKRWanNnzOT9auXMquzg7kzZzCrs4P1q5cyf87MokOzNpFyrKGfAi+XdApwCLgEqB4kaDPwLklfI7tJfCAinkgYk1lLWrVsESvOXkD//kMs7prtJGB1lSwRRMQ2SbcDO4AjwAPARklr8+0bgC3A5cBu4FngmlTxmLW6+XNmOgFYEmq1yet7enrCo4+amU2PpO0R0VNrm39ZbGZWck4EZmYl50RgZlZyTgRmZiXnRGBmVnJOBGZmJedEYGZWck4EZmYl50RgZlZyTgRmZiXnRGBmVnJOBGZmJedEYGZWck4EZmYl50RgZlZyTgRmZiXnRGBmVnJOBGZmJedEYGZWck4EZmYl50RgZlZyTgRmZiXnRGBmVnJOBGZmJZcsEUg6V9LOisczkt5btc+rJB2o2OfDqeIxMztRg0PD7NrzNINDw0WHUlczUh04Ih4FlgFIOgnYC9xZY9fvRsQVqeIwM6uHu3fu5bpNfXR2dDAyOsr61UtZtWxR0WHVRaMuDV0C/CgiHm/Q65mZ1c3g0DDXberj8MgoB4ePcHhklHWb+trmzKBRieBq4NZxtl0saZekeyS9rNYOktZI6pXUOzAwkC5KM7Ma+vcforPj6I/Lzo4O+vcfKiii+kqeCCSdDKwCvl5j8w7gxRFxPvA54K5ax4iIjRHRExE93d3dyWI1M6tlcddsRkZHj2obGR1lcdfsgiKqr0acEawEdkTEk9UbIuKZiBjKl7cAnZIWNCAmM7Mpmz9nJutXL2VWZwdzZ85gVmcH61cvZf6cmUWHVhfJbhZXeCPjXBaSdCbwZESEpAvJEtNgA2IyM5uWVcsWseLsBfTvP8TirtltkwQgcSKQdApwKfCOira1ABGxAbgKuFbSEeAQcHVERMqYzMyO1/w5M9sqAYxJmggi4llgflXbhorl64HrU8ZgZmYT8y+LzcxKzonAzKzknAjMzErOicDMrOScCMzMSs6JwMys5JwIzMxKzonAzKzknAjMzErOicDMrOScCMzMSs6JwMys5JwIzMxKzonAzKzknAjMzErOicDMrOScCMzMSs6JwMys5JwIzMxKzonAzKzknAjMzErOicDMrOScCMzMSs6JwMys5JIlAknnStpZ8XhG0nur9pGkz0raLalP0vJU8ZiZWW0zUh04Ih4FlgFIOgnYC9xZtdtK4Jz8cRFwQ/5sZmYN0qhLQ5cAP4qIx6varwRujsxWYJ6khQ2KyczMaFwiuBq4tUb7ImBPxXp/3nYUSWsk9UrqHRgYSBSimVk5JU8Ekk4GVgFfr7W5Rlsc0xCxMSJ6IqKnu7u73iGamZVaI84IVgI7IuLJGtv6gbMq1hcD+xoQk5mZ5RqRCN5I7ctCAJuBN+fVQy8HDkTEEw2IyczMcsmqhgAknQJcCryjom0tQERsALYAlwO7gWeBa1LGY2Zmx0qaCCLiWWB+VduGiuUA3pkyBjMzm5h/WWxmVnJOBGZmJedEYGZWck4EZmYl50RgZqUyODTMrj1PMzg0XHQo05Iy7kmrhiRdDPw+8DvAQuAQ8BDwTeArEXGg7lGZmSVw9869XLepj86ODkZGR1m/eimrlh0zqk3TSR33hGcEku4B3gb8HXAZWSI4D/hTYBZwt6RVdYvGzCyRwaFhrtvUx+GRUQ4OH+HwyCjrNvU1/ZlBI+Ke7IzgDyLi51VtQ8CO/PEpSQvqFo2ZWSL9+w/R2dHBYUb/ra2zo4P+/YeYP2dmgZFNrBFxT3hGMJYEJP3eZPuYmTWzxV2zGRkdPaptZHSUxV2zC4poahoR91RvFv9p3V7RzKwA8+fMZP3qpczq7GDuzBnM6uxg/eqlTX02AI2JO+kQE2ZmzWTVskWsOHsB/fsPsbhrdtMngTGp455qIjhd0p9UN0bEX9U1GrMCDQ4Nt9wHhE3f/DkzW/L/b8q4p5oIPg/MTRKBWRNo1bJCs3qYUiKIiD+vbpN0Rv3DMWu8yvK8scqMdZv6WHH2gpb85mg2XVO6WSzpRkmqWH878O1kUZk10Fh5XqWx8jyzMphq1dAPgc2Szpf0LeAi4BXpwjJrnFYtKzSrlyklgoj4S7LJ57cBfxMRb4uIp1MGZtYorVpWaFYvU7pHUFEx9G3gLyT9CrhqyNpHq5YVmtXDVKuGxiqGtuYPVxBZ22nVskKzE3XcVUNmZtYeJht9dKOk3xhn26mS3irpTWlCMzOzRpjsjOBvgD/Lk8FDwADZ8NPnAKcBXwRuSRqhmZklNWEiiIidwOslzQF6eH5imocj4tH04ZmZWWpTvUcwBHwnbShmZlaEpHMWS5on6XZJj0h6OJ/2snL7qyQdkLQzf3w4ZTxmZnas1MNQfwa4NyKuknQycEqNfb4bEVckjsPMzMYxWdXQ64/3wJJOA14J3AgQEb/0r5HNzJrPZJeG3izpXkkvPY5jv5SsyugmSQ9I+oKkU2vsd7GkXZLukfSyWgeStEZSr6TegYGB4wjFzMzGM9mcxVcAG4BvSvozSQskvXDsMcmxZwDLgRsi4gLgF8AHqvbZAbw4Is4HPgfcNU4cGyOiJyJ6uru7J++VmZlN2aQ3iyPiLuBq4P1AL7A9f/RO8qf9QH9EbMvXbydLDJXHfiavSCIitgCdkhZMpwNmZnZiJrxZLGkm2cT1VwFviohvTPXAEfEzSXsknZv/5uAS4AdVxz8TeDIiQtKFZIlpcLqdMDOz4zdZ1VAfsAlYHhHHM0vHu4Fb8oqhHwPXSFoLEBEbyBLMtZKOkP1Q7eqIiON4HTOzKfHc1MfSRJ+7ks6LiB+Mu0MBenp6ord3sqtSZmbHKvPc1JK2R0RPrW2T3SxuqiRgZna8KuemPjh8hMMjo6zb1Mfg0HDRoRUu6S+LzcyaheemHp8TgZmVguemHt+UEoGkL0uaV7HeJemLyaIyM6szz009vqmONbS0cniIiNgv6YI0IZmZpdHKc1OnrHaaaiLokNQVEfsB8l8Vpx6wzsys7lpxburU1U5T/TD/FPDPkm4HAng98D/rFoWZmdVUWe10mOwex7pNfaw4e0HdEtpUJ6a5WVIv8BpAwO+5tNTMLL2xaqexJADPVzvVKxFMp2rohcAvIuJzwICkl9QlAjMzG1cjqp2mWjX034HrgA/mTZ3AV+oWhZmZ1dSIaqep3iP4T8AFZMNGExH7JM2tWxRmZjau1NVOU00Ev8xHCA2AcSaYsSbjwbXM2kfKaqepJoLbJP1vYJ6ktwNvBT6fJCKrizIPrmVm0zPVqqFPSroUeAY4F/hwRNyfNDI7bo0oNzOz9jHlH4XlH/z35zOIefKYJtaIcjMzax8TVg1Jermk70i6Q9IFkh4CHgKelHRZY0K06fLgWmY2HZOVj14PfBS4FfgW8LaIOBN4JfCxxLHZcfLgWmY2HZNdGpoREfcBSPpIRGwFiIhHJCUPzo5fKw+uZa3BVWntY7JEUHl9oXr2Bs8t3ORacXAtaw2uSmsvkyWC8yU9Qza+0Ox8mXx9VtLIzKwpuSqt/UyYCCLipEYFYmatwVVp7cdTVZrZtLgqrf04EZjZtLgqrf14ljEzmzZXpbWXpGcEkuZJul3SI5IelnRx1XZJ+qyk3ZL6JC1PGY+Z1c/8OTM5/6x5TgLTMDg0zK49TzM4NFx0KEdJfUbwGeDeiLhK0snAKVXbVwLn5I+LgBvyZzOzttLMJbfJzggknUb2C+QbASLilxHxdNVuVwI3R2Yr2eimC1PFZGZWhMqS24PDRzg8Msq6TX1Nc2aQ8tLQS4EB4CZJD0j6Qo15DBYBeyrW+/O2o0haI6lXUu/AwEC6iM3MEhgrua00VnLbDFImghnAcuCGiLgA+AXwgap9ao1TccwvliNiY0T0RERPd3d3/SM1M0uo2UtuUyaCfqA/Irbl67eTJYbqfc6qWF8M7EsYk5lZwzV7yW2ym8UR8TNJeySdGxGPApcAP6jabTPwLklfI7tJfCAinkgVk5lZUZq55DZ11dC7gVvyiqEfA9dIWgsQERuALcDlwG7gWeCaxPGYmRWmWQeCTJoIImIn0FPVvKFiewDvTBmDmZlNzENMmJmVnBOBmVnJORGYmZWcE4GZWck5EZhZy2nWwdtalYehNrOW0syDt7UqnxGYWcto9sHbWpUTgZm1jGYfvK1VORGYWcto9sHbWpUTgZm1jGYfvK1V+WaxmbWUZh68rVU5EZjZcRkcGi7sw7hZB29rVU4EZjZtLuFsL75HYGbT4hLO9uNEYGbT4hLO9uNEYGbT4hLO9uNEYGbT4hLO9uObxWY2ba1cwllktVOzciIws+PSiiWcrnaqzZeGzKwUXO00PicCMysFVzuNz4nAzErB1U7jcyIws1JwtdP4fLPYzEqjlaudUkqaCCQ9BhwEngOORERP1fZXAXcDP8mb7oiIj6SMycyaQ1FlnEVWOzVr6WojzgheHRE/n2D7dyPiigbEYWZNooxlnM3cZ98jMLOGKmMZZ7P3OXUiCOA+SdslrRlnn4sl7ZJ0j6SX1dpB0hpJvZJ6BwYG0kVrZsmVsYyz2fuc+tLQiojYJ+l04H5Jj0TEP1Vs3wG8OCKGJF0O3AWcU32QiNgIbATo6emJxDGbWUJlLONs9j4nPSOIiH3581PAncCFVdufiYihfHkL0ClpQcqYzKxYZSzjbPY+JzsjkHQq0BERB/Pl1wEfqdrnTODJiAhJF5IlpsFUMZlZcyhjGWcz9znlpaEzgDsljb3OVyPiXklrASJiA3AVcK2kI8Ah4OqI8KWfOmnWUjVrDyf6/mrFQetOVLP2OVkiiIgfA+fXaN9QsXw9cH2qGMqsmUvVrPX5/dVeXD7ahpq9VM1am99f7ceJoA01e6matTa/v9qPE0EbavZSNWttfn+1HyeCNtTspWrW2vz+aj9qtSKdnp6e6O3tLTqMluCqIUupyPeX39vTJ2l79cCfYzwMdRtr1lI1aw9Fvb9csVR/vjRkZi3DFUtpOBGYWctwxVIaTgRm1jJcsZSGE4GZtQxXLKXhm8Vm1lKaefC2VuVEYGYtxxVx9eVLQ2ZmJedEYGZWck4EZmYl50RgZlZyTgRmZiXnRGBmVnJOBGZmJedEYGZWck4EZmYl50RgZlZyTgRmZiXnRGBmVnJJE4GkxyQ9KGmnpGMmGlbms5J2S+qTtDxVLINDw+za87RnMrJx+T1iZdWI0UdfHRE/H2fbSuCc/HERcEP+XFee49Qm4/eIlVnRl4auBG6OzFZgnqSF9XwBz3Fqk/F7xMoudSII4D5J2yWtqbF9EbCnYr0/bzuKpDWSeiX1DgwMTCsAz3Fqk/F7xMoudSJYERHLyS4BvVPSK6u2q8bfxDENERsjoicierq7u6cVgOc4tcn4PWJllzQRRMS+/Pkp4E7gwqpd+oGzKtYXA/vqGYPnOLXJ+D1iZZfsZrGkU4GOiDiYL78O+EjVbpuBd0n6GtlN4gMR8US9Y/EcpzYZv0eszFJWDZ0B3Clp7HW+GhH3SloLEBEbgC3A5cBu4FngmlTBeI5Tm4zfI1ZWyRJBRPwYOL9G+4aK5QDemSoGMzObXNHlo2ZmVjAnAjOzknMiMDMrOScCM7OSU3a/tnVIGgAeP84/XwCMN+5Ru3Kfy8F9LocT6fOLI6LmL3JbLhGcCEm9EdFTdByN5D6Xg/tcDqn67EtDZmYl50RgZlZyZUsEG4sOoADuczm4z+WQpM+lukdgZmbHKtsZgZmZVXEiMDMrubZNBJLOkvRtSQ9L+ldJf1y1/f2SQtKComKst4n6LOndkh7N29cXGWc9jddnScskbZW0M5/drnoujJYkaZak70valff3z/P2F0q6X9IP8+euomOtlwn6/AlJj0jqk3SnpHkFh1o34/W5Ynt9P78ioi0fwEJgeb48F/h/wHn5+lnA35H9MG1B0bGm7jPwauDvgZn5ttOLjrUBfb4PWJm3Xw58p+hY69RfAXPy5U5gG/ByYD3wgbz9A8DHi461AX1+HTAjb/94Gfqcr9f986ttzwgi4omI2JEvHwQe5vn5kD8NrKPGtJitbII+Xwv8ZUQM59ueKi7K+pqgzwGclu/2Auo8811RIjOUr3bmjwCuBL6ct38Z+N3GR5fGeH2OiPsi4kjevpVshsO2MMH/Z0jw+dW2iaCSpCXABcA2SauAvRGxq9io0qrsM/CrwO9I2ibpHyX9VqHBJVLV5/cCn5C0B/gk8MHiIqsvSSdJ2gk8BdwfEduAMyKf3S9/Pr3AEOtunD5XeitwT8MDS6hWn1N9frV9IpA0B9hE9sFwBPgQ8OEiY0qtss8R8QzZBERdZKfT/xW4TfnUce2iRp+vBd4XEWcB7wNuLDK+eoqI5yJiGdk34Asl/XrBISU3UZ8lfYjs3/YtBYWXRI0+LyXR51dbJwJJnWQfDrdExB3AvwNeAuyS9BjZf+Adks4sLsr6qtFngH7gjvx08/vAKNngVW1hnD6/BRhb/jrQFjeLK0XE08B3gMuAJyUtBMif2+byX6WqPiPpLcAVwJsiv4Debir6fCWJPr/aNhHk33hvBB6OiL8CiIgHI+L0iFgSEUvIPiCXR8TPCgy1bmr1OXcX8Jp8n18FTqZNRm2coM/7gH+fL78G+GGjY0tBUvdYdYyk2cBrgUeAzWTJj/z57kICTGC8Pku6DLgOWBURzxYYYt2N0+cHUn1+pZy8vmgrgD8AHsyvswH8t4jYUlxIydXsM/BF4IuSHgJ+Cbyljb49jdfntwOfkTQDOAysKSa8ulsIfFnSSWRf5G6LiG9I+h7ZJb8/An4K/Ocig6yz8fq8G5gJ3J9f6dwaEWsLjLOeavY51Yt5iAkzs5Jr20tDZmY2NU4EZmYl50RgZlZyTgRmZiXnRGBmVnJOBNZSJD2Xjyi6S9IOSa8oOqaJSJor6UeSzsnXOyU9KOmiGvtK0rcknXbskU44jr9vpxFJrb6cCKzVHIqIZRFxPtn4QR8rOqCJ5APhfRD467zp/cA/1xgrB7JRUnflQ2TU2/8B/kuC41obcCKwVnYasB/+7dv0JyQ9lH/jfkPevlTZfAQPSPoXSb+Wtz8m6eP5mO/fl3R23v4f88H5Hsi/RZ+Rt8+RdFN+7D5JqyW9Lz87+amkgXz5C9VBRsRtwKikdcBaxh8A703kvwiWtETZePNr8/WTJO2V9KV8vVvSprxP/yJpxXhx5sfeDLzxhP+LW3tKNZ62H36keADPATvJhlU4APxm3r4auB84CTiD7Ne1C6v+9qPAx/Llx4AP5ctvBr6RL3fx/A8t3wZ8Kl/+OPC/Ko7VVbH8h8D1k8T9a2TDBr99gn0eB+bmy0vIhsW4N1//D2RDLX8pX/8q8Nv58q+QDbExWZw/BOYX/f/Qj+Z7tPMQE9aeDkU2IiOSLgZuzkei/G3g1oh4jmwAtn8EfgvYLOlyskszzwErK451a8Xzp/PlxcDf5gO3nQz8JG9/LXD12B9GxP5pxn0Z8AQw0UihL4zsUtKYYWC3pJeRDaPxFaCnIp7z9PwgsqdJmjtJnE8BLwIGpxm7tTlfGrKWFRHfIxtFtZtsRqfx9tsSES8hG5zudys31Vj+HNm3+98A3gHMytvFcU4EIulFwHvIRkC9PB9OuJYjkqr/Td5ENgnJDKBycLEO4OLI7pcsi4hFeRKZKM5ZwKHj6YO1NycCa1n59f6TyL7h/hPwhvxaejfwSuD7kl5Q8SeHOfob+Rsqnr+XL78A2Jsvv6Vi3/uAd1W89nQqcD4NfDQi+oE/Af5aqjkfxKPASysbImI72SQzN1XtWx3PsonizF/vTLJLYmZHcSKwVjM7vym7E/hbspFUnwPuBPqAXcC3gHWRDc/7mvzG6YPA6zm6ymimpG3AH5NNXgPwP4CvS/ouRw/V/RdAV34zehfZPNCTknQp2TX8GwEi4v+S3eB+c43dvwm8qroxIlZGxDermt8D9OQ3hH9AdhN6ojh/k2x0ziOYVfHoo1ZKyib26ImIppmXIb8vcXNEXJrg2J8BNkfEP9T72Nb6fEZg1iQim2v48yl+UAY85CRg4/EZgZlZyfmMwMys5JwIzMxKzonAzKzknAjMzErOicDMrOT+P4ATbLF+xyuBAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "data.plot.scatter(x = 'Возраст X (мес)', y = 'Вес Y (кг)' )"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f9cf00f8",
   "metadata": {},
   "source": [
    "### Построение корреляционной таблицы и нахождение характеристик"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "991af846",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Размах возраста Х: 10.0\n",
      "Размах веса Y: 3.0\n"
     ]
    }
   ],
   "source": [
    "print(f'Размах возраста Х: {X.max() - X.min()}')\n",
    "print(f'Размах веса Y: {Y.max() - Y.min()}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "0a592b8e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Возраст X (мес)</th>\n",
       "      <th>Вес Y (кг)</th>\n",
       "      <th>Интервалы X</th>\n",
       "      <th>Интервалы Y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>33.0</td>\n",
       "      <td>7.5</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>(7.0, 8.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>31.0</td>\n",
       "      <td>5.7</td>\n",
       "      <td>(29.0, 31.5]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>31.0</td>\n",
       "      <td>5.4</td>\n",
       "      <td>(29.0, 31.5]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>32.0</td>\n",
       "      <td>5.8</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>34.0</td>\n",
       "      <td>6.8</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>(6.0, 7.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>26.0</td>\n",
       "      <td>6.2</td>\n",
       "      <td>[24.0, 26.5]</td>\n",
       "      <td>(6.0, 7.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>29.8</td>\n",
       "      <td>8.0</td>\n",
       "      <td>(29.0, 31.5]</td>\n",
       "      <td>(7.0, 8.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>31.0</td>\n",
       "      <td>6.1</td>\n",
       "      <td>(29.0, 31.5]</td>\n",
       "      <td>(6.0, 7.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>32.5</td>\n",
       "      <td>6.8</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>(6.0, 7.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>32.5</td>\n",
       "      <td>5.6</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>24.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>[24.0, 26.5]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>28.5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>(26.5, 29.0]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>26.0</td>\n",
       "      <td>5.4</td>\n",
       "      <td>[24.0, 26.5]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>28.5</td>\n",
       "      <td>6.7</td>\n",
       "      <td>(26.5, 29.0]</td>\n",
       "      <td>(6.0, 7.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>32.0</td>\n",
       "      <td>5.3</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>31.5</td>\n",
       "      <td>5.5</td>\n",
       "      <td>(29.0, 31.5]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>32.5</td>\n",
       "      <td>6.4</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>(6.0, 7.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>34.0</td>\n",
       "      <td>6.3</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>(6.0, 7.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>33.5</td>\n",
       "      <td>5.5</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>33.5</td>\n",
       "      <td>6.0</td>\n",
       "      <td>(31.5, 34.0]</td>\n",
       "      <td>[5.0, 6.0]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Возраст X (мес)  Вес Y (кг)   Интервалы X Интервалы Y\n",
       "1              33.0         7.5  (31.5, 34.0]  (7.0, 8.0]\n",
       "2              31.0         5.7  (29.0, 31.5]  [5.0, 6.0]\n",
       "3              31.0         5.4  (29.0, 31.5]  [5.0, 6.0]\n",
       "4              32.0         5.8  (31.5, 34.0]  [5.0, 6.0]\n",
       "5              34.0         6.8  (31.5, 34.0]  (6.0, 7.0]\n",
       "6              26.0         6.2  [24.0, 26.5]  (6.0, 7.0]\n",
       "7              29.8         8.0  (29.0, 31.5]  (7.0, 8.0]\n",
       "8              31.0         6.1  (29.0, 31.5]  (6.0, 7.0]\n",
       "9              32.5         6.8  (31.5, 34.0]  (6.0, 7.0]\n",
       "10             32.5         5.6  (31.5, 34.0]  [5.0, 6.0]\n",
       "11             24.0         5.0  [24.0, 26.5]  [5.0, 6.0]\n",
       "12             28.5         5.0  (26.5, 29.0]  [5.0, 6.0]\n",
       "13             26.0         5.4  [24.0, 26.5]  [5.0, 6.0]\n",
       "14             28.5         6.7  (26.5, 29.0]  (6.0, 7.0]\n",
       "15             32.0         5.3  (31.5, 34.0]  [5.0, 6.0]\n",
       "16             31.5         5.5  (29.0, 31.5]  [5.0, 6.0]\n",
       "17             32.5         6.4  (31.5, 34.0]  (6.0, 7.0]\n",
       "18             34.0         6.3  (31.5, 34.0]  (6.0, 7.0]\n",
       "19             33.5         5.5  (31.5, 34.0]  [5.0, 6.0]\n",
       "20             33.5         6.0  (31.5, 34.0]  [5.0, 6.0]"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# разобьем Х на 4 интервала, а Y на 3 интервала\n",
    "data['Интервалы X'] = pd.cut(data['Возраст X (мес)'], bins=4,precision=20, include_lowest=True)\n",
    "data['Интервалы Y'] = pd.cut(data['Вес Y (кг)'], bins=3, precision=20, include_lowest=True)\n",
    "\n",
    "# включаем границы \n",
    "data['Интервалы Y'] = data['Интервалы Y'].apply(lambda x: pd.Interval(min(Y), x.right, closed='both') if x.left < min(Y) else x)\n",
    "data['Интервалы X'] = data['Интервалы X'].apply(lambda x: pd.Interval(min(X), x.right, closed='both') if x.left < min(X) else x)\n",
    "\n",
    "display(data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "2a0e9be7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Возраст X (мес)</th>\n",
       "      <th>Вес Y (кг)</th>\n",
       "      <th>Интервалы X</th>\n",
       "      <th>Интервалы Y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>24.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>25.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>26.0</td>\n",
       "      <td>6.2</td>\n",
       "      <td>25.25</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>26.0</td>\n",
       "      <td>5.4</td>\n",
       "      <td>25.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>28.5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>28.5</td>\n",
       "      <td>6.7</td>\n",
       "      <td>27.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>29.8</td>\n",
       "      <td>8.0</td>\n",
       "      <td>30.25</td>\n",
       "      <td>7.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>31.0</td>\n",
       "      <td>5.7</td>\n",
       "      <td>30.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>31.0</td>\n",
       "      <td>5.4</td>\n",
       "      <td>30.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>31.0</td>\n",
       "      <td>6.1</td>\n",
       "      <td>30.25</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>31.5</td>\n",
       "      <td>5.5</td>\n",
       "      <td>30.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>32.0</td>\n",
       "      <td>5.8</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>32.0</td>\n",
       "      <td>5.3</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>32.5</td>\n",
       "      <td>5.6</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>32.5</td>\n",
       "      <td>6.4</td>\n",
       "      <td>32.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>32.5</td>\n",
       "      <td>6.8</td>\n",
       "      <td>32.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>33.0</td>\n",
       "      <td>7.5</td>\n",
       "      <td>32.75</td>\n",
       "      <td>7.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>33.5</td>\n",
       "      <td>5.5</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>33.5</td>\n",
       "      <td>6.0</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>34.0</td>\n",
       "      <td>6.8</td>\n",
       "      <td>32.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>34.0</td>\n",
       "      <td>6.3</td>\n",
       "      <td>32.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Возраст X (мес)  Вес Y (кг) Интервалы X Интервалы Y\n",
       "11             24.0         5.0       25.25         5.5\n",
       "6              26.0         6.2       25.25         6.5\n",
       "13             26.0         5.4       25.25         5.5\n",
       "12             28.5         5.0       27.75         5.5\n",
       "14             28.5         6.7       27.75         6.5\n",
       "7              29.8         8.0       30.25         7.5\n",
       "2              31.0         5.7       30.25         5.5\n",
       "3              31.0         5.4       30.25         5.5\n",
       "8              31.0         6.1       30.25         6.5\n",
       "16             31.5         5.5       30.25         5.5\n",
       "4              32.0         5.8       32.75         5.5\n",
       "15             32.0         5.3       32.75         5.5\n",
       "10             32.5         5.6       32.75         5.5\n",
       "17             32.5         6.4       32.75         6.5\n",
       "9              32.5         6.8       32.75         6.5\n",
       "1              33.0         7.5       32.75         7.5\n",
       "19             33.5         5.5       32.75         5.5\n",
       "20             33.5         6.0       32.75         5.5\n",
       "5              34.0         6.8       32.75         6.5\n",
       "18             34.0         6.3       32.75         6.5"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data.sort_values('Возраст X (мес)')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "cac8cd13",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Возраст X (мес)</th>\n",
       "      <th>Вес Y (кг)</th>\n",
       "      <th>Интервалы X</th>\n",
       "      <th>Интервалы Y</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>33.0</td>\n",
       "      <td>7.5</td>\n",
       "      <td>32.75</td>\n",
       "      <td>7.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>31.0</td>\n",
       "      <td>5.7</td>\n",
       "      <td>30.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>31.0</td>\n",
       "      <td>5.4</td>\n",
       "      <td>30.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>32.0</td>\n",
       "      <td>5.8</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>34.0</td>\n",
       "      <td>6.8</td>\n",
       "      <td>32.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>26.0</td>\n",
       "      <td>6.2</td>\n",
       "      <td>25.25</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>29.8</td>\n",
       "      <td>8.0</td>\n",
       "      <td>30.25</td>\n",
       "      <td>7.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>31.0</td>\n",
       "      <td>6.1</td>\n",
       "      <td>30.25</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>32.5</td>\n",
       "      <td>6.8</td>\n",
       "      <td>32.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>32.5</td>\n",
       "      <td>5.6</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>24.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>25.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>28.5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>27.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>26.0</td>\n",
       "      <td>5.4</td>\n",
       "      <td>25.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>28.5</td>\n",
       "      <td>6.7</td>\n",
       "      <td>27.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>32.0</td>\n",
       "      <td>5.3</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>31.5</td>\n",
       "      <td>5.5</td>\n",
       "      <td>30.25</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>32.5</td>\n",
       "      <td>6.4</td>\n",
       "      <td>32.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>34.0</td>\n",
       "      <td>6.3</td>\n",
       "      <td>32.75</td>\n",
       "      <td>6.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>33.5</td>\n",
       "      <td>5.5</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>33.5</td>\n",
       "      <td>6.0</td>\n",
       "      <td>32.75</td>\n",
       "      <td>5.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Возраст X (мес)  Вес Y (кг) Интервалы X Интервалы Y\n",
       "1              33.0         7.5       32.75         7.5\n",
       "2              31.0         5.7       30.25         5.5\n",
       "3              31.0         5.4       30.25         5.5\n",
       "4              32.0         5.8       32.75         5.5\n",
       "5              34.0         6.8       32.75         6.5\n",
       "6              26.0         6.2       25.25         6.5\n",
       "7              29.8         8.0       30.25         7.5\n",
       "8              31.0         6.1       30.25         6.5\n",
       "9              32.5         6.8       32.75         6.5\n",
       "10             32.5         5.6       32.75         5.5\n",
       "11             24.0         5.0       25.25         5.5\n",
       "12             28.5         5.0       27.75         5.5\n",
       "13             26.0         5.4       25.25         5.5\n",
       "14             28.5         6.7       27.75         6.5\n",
       "15             32.0         5.3       32.75         5.5\n",
       "16             31.5         5.5       30.25         5.5\n",
       "17             32.5         6.4       32.75         6.5\n",
       "18             34.0         6.3       32.75         6.5\n",
       "19             33.5         5.5       32.75         5.5\n",
       "20             33.5         6.0       32.75         5.5"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# середины интервалов\n",
    "data['Интервалы Y'] = data['Интервалы Y'].apply(lambda x: round(x.mid, 2))\n",
    "data['Интервалы X'] = data['Интервалы X'].apply(lambda x: round(x.mid, 2))\n",
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "131019bc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>X</th>\n",
       "      <th>25.25</th>\n",
       "      <th>27.75</th>\n",
       "      <th>30.25</th>\n",
       "      <th>32.75</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Y</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>5.5</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6.5</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7.5</th>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "X    25.25  27.75  30.25  32.75\n",
       "Y                              \n",
       "5.5      2      1      3      5\n",
       "6.5      1      1      1      4\n",
       "7.5      0      0      1      1"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Построим корреляционную таблицу\n",
    "correlation_table = data.groupby(['Интервалы Y', 'Интервалы X']).count()\n",
    "\n",
    "del correlation_table['Возраст X (мес)']\n",
    "correlation_table = correlation_table.reset_index()\n",
    "correlation_table = correlation_table.rename(columns = {'Вес Y (кг)': 'count',\n",
    "                                 'Интервалы Y': 'Y', 'Интервалы X': 'X'})\n",
    "correlation_table = correlation_table.pivot(index='Y', columns='X', values='count')\n",
    "display(correlation_table)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "0bcb120c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Условные средние y при X = x_i:  [5.833 6.    6.1   6.1  ]\n",
      "Полное среднее:  6.05\n",
      "Межгрупповая дисперсия:  0.009\n",
      "Полная дисперсия:  0.447\n",
      "Корреляционное отношение: 0.142\n"
     ]
    }
   ],
   "source": [
    "# найдем характеристики\n",
    "y_points = correlation_table.index.values.to_numpy()\n",
    "x_points = correlation_table.columns.values.to_numpy()\n",
    "\n",
    "\n",
    "\n",
    "#--------------------Условные средние-----------------------------------------------\n",
    "mean_y_i = []\n",
    "for column in x_points:\n",
    "    if np.sum(correlation_table[column].values) == 0:\n",
    "        mean_y_i.append(0.0000000000000001)\n",
    "        continue\n",
    "    value = np.sum(correlation_table[column].values * y_points) / (correlation_table[column].values.sum())\n",
    "    mean_y_i.append(round(value, 3))\n",
    "mean_y_i = np.array(mean_y_i)\n",
    "print('Условные средние y при X = x_i: ', mean_y_i)\n",
    "\n",
    "\n",
    "\n",
    "#--------------------Полное среднее---------------------------------------------------------\n",
    "N = (correlation_table.sum().sum()) # всего элементов (длина изначальной выборки)\n",
    "mean_y = np.sum(correlation_table.sum(1).values * y_points) / N\n",
    "mean_y = round(mean_y, 3)\n",
    "print('Полное среднее: ', mean_y)\n",
    "\n",
    "\n",
    "\n",
    "#-----------------Межгрупповая дисперсия------------------------------------------------------\n",
    "variance_between_groups = np.sum(correlation_table.sum(0).values * (mean_y_i - mean_y)**2) / N\n",
    "variance_between_groups = round(variance_between_groups, 3)\n",
    "print('Межгрупповая дисперсия: ', variance_between_groups)\n",
    "\n",
    "\n",
    "\n",
    "#-----------------Полная дисперсия------------------------------------------------------------\n",
    "variance =  np.sum(correlation_table.sum(1).values * (y_points - mean_y)**2) / N\n",
    "variance = round(variance, 3)\n",
    "print('Полная дисперсия: ', variance)\n",
    "\n",
    "\n",
    "\n",
    "#-----------------Корреляционное отношение-----------------------------------------------------------\n",
    "relation_correlation = np.sqrt(variance_between_groups / variance)\n",
    "relation_correlation = round(relation_correlation, 3)\n",
    "print('Корреляционное отношение:', relation_correlation)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "30bb5a9b",
   "metadata": {},
   "source": [
    "### Гипотеза о значимости корреляционного отношения\n",
    "Выдвигаем гипотезу:  \n",
    "$H_0$: $\\eta_{yx} = 0$ (между Y и X нет зависимости)  \n",
    "Задаем уровень значимости: $0.05$  \n",
    "Для проверки используем критерий Стьюдента"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "0b52505b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "t теоретическое = 1.734, t наблюдаемое = 0.609\n"
     ]
    }
   ],
   "source": [
    "from scipy.stats import t\n",
    "t_current = round(relation_correlation * np.sqrt((N-2) / (1-relation_correlation**2)), 3)\n",
    "t_theory = round(t.isf(q=0.05, df=N-2), 3)\n",
    "print(f't теоретическое = {t_theory}, t наблюдаемое = {t_current}')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ba2e9e27",
   "metadata": {},
   "source": [
    "Наблюдаемое значение критерия меньше теоретического, значит с заданным уровнем значимости 0.05 нет оснований отклонить нулевую гипотезу.\n",
    "Таким образом, между весом и возрастом нет зависимости."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  },
  "toc": {
   "base_numbering": 1,
   "nav_menu": {},
   "number_sections": true,
   "sideBar": true,
   "skip_h1_title": false,
   "title_cell": "Table of Contents",
   "title_sidebar": "Contents",
   "toc_cell": false,
   "toc_position": {},
   "toc_section_display": true,
   "toc_window_display": false
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
